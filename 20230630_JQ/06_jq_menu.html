<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .box {
            background-color: lightblue;
        }
    </style>

</head>

<body>
    <div class="container text-center">
        <div class="row">
            <div class="col-1">
                編號
            </div>
            <div class="col-3">
                圖片
            </div>
            <div class="col-1">
                單價
            </div>
            <div class="col-1">
                數量
            </div>
            <div class="col-2">
                小計
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-1">
                1
            </div>
            <div class="col-3">
                <img src="https://picsum.photos/id/241/200/200" alt="">
            </div>
            <div class="col-1">
                <input type="number" class="form-control price" name="price" value="100">
            </div>
            <div class="col-1">
                <input type="number" class="form-control num" name="num" value="1" min="0">
            </div>
            <div class="col-2">
                <input type="number" class="form-control total" name="total" value="0">
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-1">
                1
            </div>
            <div class="col-3">
                <img src="https://picsum.photos/id/241/200/200" alt="">
            </div>
            <div class="col-1">
                <input type="number" class="form-control price" name="price" value="200">
            </div>
            <div class="col-1">
                <input type="number" class="form-control num" name="num" value="1" min="0">
            </div>
            <div class="col-2">
                <input type="number" class="form-control total" name="total" value="0">
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <div class="row">
            <div class="col">
                <p id="myP">
                    55688
                </p>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
        integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script>
        // 1.改變時 抓price num
        // 2.result = price * num
        // 3.total = result，只要改變，全部資料變動
        // 4.sum = all total 
        $(document).ready(function () {
            // 1.綁定
            let rows = $('.row'); //綁定所有的row class
            let totals = $('.total'); //綁定所有的total class

            // 2.num class的change事件
            $('.num').change(function (e) {
                let numValue = $(this).val();
                console.log('numValue', numValue);

                // 將rows的全部資料存取出來
                $.each(rows, function (key, value) {
                    if (key > 0) {
                        console.log('key', key);
                        console.log('value', value);
                        // 抓row -> price x number 
                        let priceValue = Number($(value).find('.price').val());
                        let numValue = Number($(value).find('.num').val());
                        console.log('priceValue', priceValue);
                        let result = priceValue * numValue;

                        // 將result存入total的值
                        // let total = Number($(value).find('.total'));
                        let total = $(value).find('.total');
                        total.val(result);

                        // 將全部的total值加總
                        let sum = 0;
                        $.each(totals, function (indexInArray, valueOfElement) {
                            console.log('indexInArray', indexInArray);
                            console.log('valueOfElement', valueOfElement);
                            console.log('$(this).val()',$(this).val());
                            sum = sum + Number($(this).val());
                        });

                        $('#myP').text(sum);
                    }
                });
            });


        });
    </script>
</body>

</html>